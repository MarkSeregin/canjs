<body>
<div id='demo-html'>
<task-editor></task-editor>
</div>

<script>
	steal = { forceES5: false };
</script>
<script src="../../node_modules/steal/steal.js" dev-bundle main="@empty" id="demo-source">
import { fromAttribute, ObservableObject, stache, StacheElement, type } from "can";
import "can/demos/technology-overview/component-slider";

var Integer = {
	[Symbol.for("can.new")](val) {
		return parseInt(val);
	},
	[Symbol.for("can.isMember")](val) {
		return Number.isInteger(val);
	}
};

class TaskEditor extends StacheElement {
    static get view() {
        return `
            <h2>Task Editor</h2>
            <form on:submit='save(scope.event)'>
                Name: {{ name }}
                <p>
                    <input bind='name'/>
                </p>
                Progress: {{ progress }}
                <p>
                    <percent-slider value:bind='progress'/>
                </p>
                <button disabled:from="isSaving">
                    {{# if(isSaving) }}Saving{{ else }}Save{{/ if }}
                </button>
            </form>
        `;
    }

    static get props() {
        return {
            taskId: type.maybeConvert(Number),

            name: {
                get() {
                    return "Task "+this.taskId;
                }
            },

            progress: {
                // makes progress an integer
                type: type.convert(Integer),
                default: 0
            },

            isSaving: {default: false}
        };
    }

    save(event) {
        event.preventDefault();
        this.isSaving = true;
        // fake ajax request
        setTimeout(() => {
            this.isSaving = false;
        },2000)
    }
}

customElements.define("task-editor", TaskEditor);
document.querySelector("task-editor").taskId = 44;
</script>
<style>
.slider {
    border: solid 1px blue;
    background-color: red;
    height: 20px;
    width: 20px;
    cursor: ew-resize;
    position: relative;
}
percent-slider {
    border: solid 1px black;
    padding: 2px;
    display: block;
}
p {
    margin: 0px 0px 20px 0px;
}
</style>
</body>
